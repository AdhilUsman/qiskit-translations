


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es-MX" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es-MX" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Uso avanzado del VQE &mdash; documentación de Qiskit - 0.24.1</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="IQPE y la evolución del estado de salida de VQE" href="05_iqpe_from_vqe.html" />
    <link rel="prev" title="VQE en el simulador Aer con ruido" href="03_vqe_simulation_with_noise.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://quantum-computing.ibm.com/" target="_blank">IBM Quantum Dashboard</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">es_MX</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Idiomas</dt>
      
        <dd><a class="version" href="/documentation/tutorials/algorithms/04_vqe_advanced.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/tutorials/algorithms/04_vqe_advanced.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/tutorials/algorithms/04_vqe_advanced.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/tutorials/algorithms/04_vqe_advanced.html">Korean</a></dd>
      
        <dd><a class="version" href="/documentation/locale/pt_BR/tutorials/algorithms/04_vqe_advanced.html">Portuguese, Brazilian</a></dd>
      
        <dd><a class="version" href="/documentation/locale/fr_FR/tutorials/algorithms/04_vqe_advanced.html">French</a></dd>
      
    </dl>
    
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../qc_intro.html">Computación cuántica en pocas palabras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Instalación de Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Primeros Pasos con Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the_elements.html">Los Elementos de Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_strategy.html">Estrategia de Desarrollo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_to_qiskit.html">Contribuir a Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuración Local</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Preguntas frecuentes</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutoriales</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../circuits/index.html">Circuitos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../circuits_advanced/index.html">Circuitos Avanzados</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulators/index.html">Simuladores de Alto Desempeño</a></li>
<li class="toctree-l1"><a class="reference internal" href="../noise/index.html">Análisis de Error en Sistemas Cuánticos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Algoritmos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operators/index.html">Operadores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimization/index.html">Optimización</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finance/index.html">Finanzas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chemistry/index.html">Química</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine_learning/index.html">Aprendizaje Automático</a></li>
</ul>
<p class="caption"><span class="caption-text">Bibliotecas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/circuit_library.html">Biblioteca de Circuitos</a></li>
</ul>
<p class="caption"><span class="caption-text">Referencia de la API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/terra.html">Qiskit Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aer.html">Qiskit Aer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ignis.html">Qiskit Ignis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aqua.html">Qiskit Aqua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ibmq-provider.html">Proveedor Cuántico IBM Qiskit</a></li>
</ul>
<p class="caption"><span class="caption-text">Solución de Problemas</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/docs/cloud/errors">Códigos de error de IBM Quantum API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="index.html">Tutoriales de algoritmos</a> &gt;</li>
        
      <li>Uso avanzado del VQE</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/algorithms/04_vqe_advanced.ipynb" rel="nofollow"><img src="../../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Esta página fue generada a partir de <a class="reference external" href="https://github.com/Qiskit/qiskit-tutorials/blob/master/tutorials/algorithms/04_vqe_advanced.ipynb">tutorials/algorithms/04_vqe_advanced.ipynb</a>.</p>
<p>Puedes correr esta sección de manera interactiva en el <a class="reference external" href="https://quantum-computing.ibm.com/jupyter/tutorial/algorithms/04_vqe_advanced.ipynb">IBM Quantum lab</a>.</p>
</div>
<div class="section" id="Uso-avanzado-del-VQE">
<h1>Uso avanzado del VQE<a class="headerlink" href="#Uso-avanzado-del-VQE" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Existen varios parámetros para configurar y usar capacidades más avanzadas del <a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.aqua.algorithms.VQE.html">VQE</a>. Este tutorial va a cubrir los parámetros como <code class="docutils literal notranslate"><span class="pre">initial_point</span></code>, <code class="docutils literal notranslate"><span class="pre">expectation</span></code> y``gradient``.</p>
<p>También cubrirá el uso avanzado del simulador, tal como el uso de Aer con el método de tren de tensores —también conocido como Matriz Product State o MPS.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">BasicAer</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua.operators</span> <span class="kn">import</span> <span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">I</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua</span> <span class="kn">import</span> <span class="n">QuantumInstance</span><span class="p">,</span> <span class="n">aqua_globals</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua.algorithms</span> <span class="kn">import</span> <span class="n">VQE</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua.components.optimizers</span> <span class="kn">import</span> <span class="n">SLSQP</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">TwoLocal</span>
</pre></div>
</div>
</div>
<p>Aquí usaremos el mismo operador que se uso en los otros tutoriales de algoritmos VQE.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">H2_op</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.052373245772859</span> <span class="o">*</span> <span class="n">I</span> <span class="o">^</span> <span class="n">I</span><span class="p">)</span> <span class="o">+</span> \
        <span class="p">(</span><span class="mf">0.39793742484318045</span> <span class="o">*</span> <span class="n">I</span> <span class="o">^</span> <span class="n">Z</span><span class="p">)</span> <span class="o">+</span> \
        <span class="p">(</span><span class="o">-</span><span class="mf">0.39793742484318045</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">^</span> <span class="n">I</span><span class="p">)</span> <span class="o">+</span> \
        <span class="p">(</span><span class="o">-</span><span class="mf">0.01128010425623538</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">^</span> <span class="n">Z</span><span class="p">)</span> <span class="o">+</span> \
        <span class="p">(</span><span class="mf">0.18093119978423156</span> <span class="o">*</span> <span class="n">X</span> <span class="o">^</span> <span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Punto-inicial">
<h2>Punto inicial<a class="headerlink" href="#Punto-inicial" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El parámetro <code class="docutils literal notranslate"><span class="pre">initial_point</span></code> permite que la optimización empiece en el punto dado, donde el punto es un lista de parámetros que van a configurar la forma variacional. Por defecto el punto inicial es <code class="docutils literal notranslate"><span class="pre">None</span></code> que significa que el VQE va a elegir uno. La decisión en este caso es que si la forma variacional dada tiene un punto preferencial basado en el estado inicial que se le provee, este será elegido, de otra manera, se elegirá un punto aleatorio que se ajuste correctamente con los limites del variacional. Si el punto inicial es dado, este tomará prioridad -sin embargo el largo de este debe ser igual que el largo del numero de parámetros en el circuito de la forma variacional.</p>
<p>¿Por qué usar un punto inicial? Una razón puede ser que ya tengas una idea razonable de un punto inicial para el problema, o quizá tengas información de un experimento anterior.</p>
<p>Para mostrar su uso, primero hay que repetir el primer ejemplo del tutorial introducción a algoritmos para obtener el punto optimo de una solución.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.aqua</span> <span class="kn">import</span> <span class="n">aqua_globals</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>
<span class="n">qi</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">),</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">pprint</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 72,
    &#39;eigenstate&#39;: array([-9.55448660e-05+2.12037105e-17j,  9.93766273e-01+2.25293943e-16j,
       -1.11483565e-01+1.52657541e-16j, -1.77521351e-05+3.71607315e-17j]),
    &#39;eigenvalue&#39;: (-1.857275017559769+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[0]): 4.296520551468743,
                              Parameter(θ[1]): 4.426962086704216,
                              Parameter(θ[2]): 0.5470753710293924,
                              Parameter(θ[3]): 6.09294789784282,
                              Parameter(θ[4]): -2.598325857134344,
                              Parameter(θ[5]): 1.5683261371389359,
                              Parameter(θ[6]): -4.717618235040379,
                              Parameter(θ[7]): 0.3602072316165878},
    &#39;optimal_point&#39;: array([ 4.29652055,  4.42696209,  0.54707537,  6.0929479 , -2.59832586,
        1.56832614, -4.71761824,  0.36020723]),
    &#39;optimal_value&#39;: -1.857275017559769,
    &#39;optimizer_evals&#39;: 72,
    &#39;optimizer_time&#39;: 1.2399418354034424}
</pre></div></div>
</div>
<p>Ahora podemos tomar el <code class="docutils literal notranslate"><span class="pre">optimal_point``del</span> <span class="pre">resultado</span> <span class="pre">de</span> <span class="pre">arriba</span> <span class="pre">y</span> <span class="pre">usarlo</span> <span class="pre">como</span> <span class="pre">el</span> <span class="pre">``initial_point</span></code> aquí.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">initial_pt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">optimal_point</span>

<span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>
<span class="n">qi</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">),</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_pt</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">)</span>
<span class="n">result1</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 10,
    &#39;eigenstate&#39;: array([-9.55448660e-05+2.12037105e-17j,  9.93766273e-01+2.25293943e-16j,
       -1.11483565e-01+1.52657541e-16j, -1.77521351e-05+3.71607315e-17j]),
    &#39;eigenvalue&#39;: (-1.857275017559769+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[1]): 4.426962086704216,
                              Parameter(θ[0]): 4.296520551468743,
                              Parameter(θ[4]): -2.598325857134344,
                              Parameter(θ[6]): -4.717618235040379,
                              Parameter(θ[3]): 6.09294789784282,
                              Parameter(θ[2]): 0.5470753710293924,
                              Parameter(θ[5]): 1.5683261371389359,
                              Parameter(θ[7]): 0.3602072316165878},
    &#39;optimal_point&#39;: array([ 4.29652055,  4.42696209,  0.54707537,  6.0929479 , -2.59832586,
        1.56832614, -4.71761824,  0.36020723]),
    &#39;optimal_value&#39;: -1.857275017559769,
    &#39;optimizer_evals&#39;: 10,
    &#39;optimizer_time&#39;: 0.27449989318847656}
</pre></div></div>
</div>
<p>Aquí podemos ver que el resultado ha sido obtenido mucho más rápido, donde``optimizer_evals`` es 10 en lugar de 72 cuando comenzó con un valor aleatorio y donde el punto inicial no fue establecido (predeterminado o ninguno).</p>
<p>Esto puede ser bastante útil para ejemplos donde la solución a un problema puede ser usado para una suposición para una solución a un problema muy similar. La química es un muy buen ejemplo donde cambiamos las distancias inter-atómicas de una molécula para graficar un perfil de disociación. Cuando los cambios de distancia son pequeños esperamos que la solución sea cercana a la anterior. Una técnica es simplemente usar el punto optimo de una solución como el punto de partida para el siguiente paso. Hay técnicas mas complejas que utilizan extrapolaciones para calcular un punto inicial basado en los resultados anteriores, en vez de directamente usar la solución anterior. El tutorial de Qiskit Chemistry <cite>sampling_potential_energy_surfaces &lt;../chemistry/05_Sampling_potential_energy_surfaces.ipynb#Extrapolation&gt;</cite> muestra este bootstrapping y extrapolación.</p>
</div>
<div class="section" id="Valor-Esperado">
<h2>Valor Esperado<a class="headerlink" href="#Valor-Esperado" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La energía del operador Hamiltoniano que el VQE esta utilizando es el valor esperado cuando se evalúa con la forma variacional parametrizada. Para calcular el valor esperado VQE utiliza una instancia de un objeto <a class="reference external" href="https://qiskit.org/documentation/apidoc/qiskit.aqua.operators.expectations.html">expectation</a>. Dicha instancia puede ser suministrada utilizando el parámetro <code class="docutils literal notranslate"><span class="pre">expectation</span></code>, o en el caso por defecto, donde tiene un valor de <code class="docutils literal notranslate"><span class="pre">None</span></code>, el VQE va a usar <a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.aqua.operators.expectations.ExpectationFactory.html">ExpectationFactory</a> para crear una instancia por si solo basada en el backend suministrado.</p>
<p>Para la mayoría de los casos, permitir que VQE cree una instancia adecuada es suficiente. Sin embargo, Qiskit Aer qasm_simulator soporta la instrucción «snapshot» que se puede usar junto con el cálculo de valor esperado del operador. Si se utiliza, entonces el resultado es ideal— es decir, como el simulador de vectores de estado— y no tiene ruido de disparo. Dado que normalmente la gente elige el simulador qasm_simulador para que haya ruido en las mediciones (ruido de muestreo) y que sea más parecido a un resultado de un dispositivo real, VQE tiene el flag <code class="docutils literal notranslate"><span class="pre">include_custom</span></code> que es pasado a ExpectationFactory. Cuando se usa el simulador qasm de Aer y esto es <code class="docutils literal notranslate"><span class="pre">True</span></code>, ExpectationFactory devolverá <code class="docutils literal notranslate"><span class="pre">AerPauliExpectation</span></code> que usa la instrucción snapshot, cuando sea `` False <code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">por</span> <span class="pre">defecto,</span> <span class="pre">devuelve</span> <span class="pre">el</span> <span class="pre">``PauliExpectation</span></code> normal.</p>
<p>El siguiente ejemplo muestra <code class="docutils literal notranslate"><span class="pre">include_custom=True</span></code> donde el resultado coincide con el simulador de vectores de estado. De hecho, puede ser mejor/más rápido hacer esto en lugar de utilizar el statevector_simulator directamente. Esto es porque, cuando el Hamiltoniano es una suma de matrices de Pauli, este debe ser convertido a forma matricial y al usar la instrucción snapshot cuando include_custom es True, esto es evitado.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>

<span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>
<span class="n">qi</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">,</span> <span class="n">include_custom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 72,
    &#39;eigenstate&#39;: {&#39;01&#39;: 1008, &#39;10&#39;: 16},
    &#39;eigenvalue&#39;: (-1.8572750175597519+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[0]): 4.296520463599476,
                              Parameter(θ[1]): 4.426962139199476,
                              Parameter(θ[2]): 0.5470754235069875,
                              Parameter(θ[3]): 6.092947836794945,
                              Parameter(θ[4]): -2.5983258956331645,
                              Parameter(θ[5]): 1.568326000491598,
                              Parameter(θ[6]): -4.717618128585369,
                              Parameter(θ[7]): 0.3602072910298268},
    &#39;optimal_point&#39;: array([ 4.29652046,  4.42696214,  0.54707542,  6.09294784, -2.5983259 ,
        1.568326  , -4.71761813,  0.36020729]),
    &#39;optimal_value&#39;: -1.8572750175597519,
    &#39;optimizer_evals&#39;: 72,
    &#39;optimizer_time&#39;: 1.2052154541015625}
</pre></div></div>
</div>
<p>En caso de que tengas dudas, aquí esta el qasm_simulator pero include_custom se ha dejado con su valor predeterminado, False. La optimización termina de manera abrupta, presuntamente causado porque el ruido de muestreo confunde al optimizador SLSQP. Además, se puede ver que el valor óptimo es incorrecto, esto es -1.098 contra el valor correcto de -1.857.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>
<span class="n">qi</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 10,
    &#39;eigenstate&#39;: {&#39;00&#39;: 620, &#39;01&#39;: 244, &#39;10&#39;: 159, &#39;11&#39;: 1},
    &#39;eigenvalue&#39;: (-1.0987888676631705+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[5]): 1.8462931831829383,
                              Parameter(θ[6]): -5.466043598406607,
                              Parameter(θ[7]): 0.6984088030463615,
                              Parameter(θ[2]): 0.6019852007557844,
                              Parameter(θ[1]): 4.19301252102391,
                              Parameter(θ[0]): 3.611860069224077,
                              Parameter(θ[4]): -3.3070470445355764,
                              Parameter(θ[3]): 5.949536809130025},
    &#39;optimal_point&#39;: array([ 3.61186007,  4.19301252,  0.6019852 ,  5.94953681, -3.30704704,
        1.84629318, -5.4660436 ,  0.6984088 ]),
    &#39;optimal_value&#39;: -1.0987888676631705,
    &#39;optimizer_evals&#39;: 10,
    &#39;optimizer_time&#39;: 0.5309410095214844}
</pre></div></div>
</div>
<p>Cambiar el optimizador a SPSA, que esta diseñado para trabajar en ambientes con ruido nos da un mejor resultado. Pero el ruido afectó el resultado entonces no es tan preciso.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.aqua.components.optimizers</span> <span class="kn">import</span> <span class="n">SPSA</span>

<span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>
<span class="n">qi</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SPSA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 241,
    &#39;eigenstate&#39;: {&#39;01&#39;: 1007, &#39;10&#39;: 17},
    &#39;eigenvalue&#39;: (-1.8623464125433034+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[3]): 7.149874669811867,
                              Parameter(θ[7]): -1.8648388048829714,
                              Parameter(θ[2]): 2.146860065695897,
                              Parameter(θ[1]): 2.0047037904408738,
                              Parameter(θ[5]): 0.026059065222908795,
                              Parameter(θ[6]): -4.4426207121597745,
                              Parameter(θ[4]): -4.6685058886658455,
                              Parameter(θ[0]): 4.731406884288576},
    &#39;optimal_point&#39;: array([ 4.73140688,  2.00470379,  2.14686007,  7.14987467, -4.66850589,
        0.02605907, -4.44262071, -1.8648388 ]),
    &#39;optimal_value&#39;: -1.8623464125433034,
    &#39;optimizer_time&#39;: 11.047632932662964}
</pre></div></div>
</div>
<p>As mentioned above, an expectation object can be explicitly given (so the internal <code class="docutils literal notranslate"><span class="pre">ExpectationFactory</span></code> and include_custom are never used/needed. Below we create an <code class="docutils literal notranslate"><span class="pre">AerPauliExpectation</span></code> and pass this to VQE. We can see the result matches that above where we set include_custom to True and let VQE create its own expectation object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.aqua.operators</span> <span class="kn">import</span> <span class="n">AerPauliExpectation</span>

<span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>
<span class="n">qi</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">,</span>
          <span class="n">expectation</span><span class="o">=</span><span class="n">AerPauliExpectation</span><span class="p">())</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 72,
    &#39;eigenstate&#39;: {&#39;01&#39;: 1008, &#39;10&#39;: 16},
    &#39;eigenvalue&#39;: (-1.8572750175597519+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[5]): 1.568326000491598,
                              Parameter(θ[6]): -4.717618128585369,
                              Parameter(θ[4]): -2.5983258956331645,
                              Parameter(θ[2]): 0.5470754235069875,
                              Parameter(θ[3]): 6.092947836794945,
                              Parameter(θ[7]): 0.3602072910298268,
                              Parameter(θ[0]): 4.296520463599476,
                              Parameter(θ[1]): 4.426962139199476},
    &#39;optimal_point&#39;: array([ 4.29652046,  4.42696214,  0.54707542,  6.09294784, -2.5983259 ,
        1.568326  , -4.71761813,  0.36020729]),
    &#39;optimal_value&#39;: -1.8572750175597519,
    &#39;optimizer_evals&#39;: 72,
    &#39;optimizer_time&#39;: 1.3454556465148926}
</pre></div></div>
</div>
<p>Por defecto, el objeto <code class="docutils literal notranslate"><span class="pre">PauliExpectation</span></code>, que seria elegido cuando include_custom es False (o cuando usamos el BasicAer qasm_simulator o un dispositivo real) agrupa los Paulis en conjuntos conmutadores. Esto es eficiente porque corre menos circuitos para calcular el valor esperado. Sin embargo, si por alguna razón quisieras correr un circuito para cada Pauli, entonces este agrupamiento puede ser apagado al construir el PauliExpectation. Pero necesitas pasar tal instancia al VQE explícitamente, para que pueda funcionar de esta manera como se muestra en seguida.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.aqua.operators</span> <span class="kn">import</span> <span class="n">PauliExpectation</span>

<span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>
<span class="n">qi</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">),</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">seed_simulator</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SPSA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">,</span>
          <span class="n">expectation</span><span class="o">=</span><span class="n">PauliExpectation</span><span class="p">(</span><span class="n">group_paulis</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 241,
    &#39;eigenstate&#39;: {&#39;01&#39;: 1007, &#39;10&#39;: 17},
    &#39;eigenvalue&#39;: (-1.8667499370593512+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[1]): 2.1216349904032947,
                              Parameter(θ[7]): -1.9698662442728732,
                              Parameter(θ[5]): 0.2634941452871489,
                              Parameter(θ[6]): -4.360567678129973,
                              Parameter(θ[0]): 4.718047005792739,
                              Parameter(θ[4]): -4.733789920734712,
                              Parameter(θ[2]): 2.1876557567510497,
                              Parameter(θ[3]): 7.317481602611872},
    &#39;optimal_point&#39;: array([ 4.71804701,  2.12163499,  2.18765576,  7.3174816 , -4.73378992,
        0.26349415, -4.36056768, -1.96986624]),
    &#39;optimal_value&#39;: -1.8667499370593512,
    &#39;optimizer_time&#39;: 20.964618682861328}
</pre></div></div>
</div>
</div>
<div class="section" id="Gradiente">
<h2>Gradiente<a class="headerlink" href="#Gradiente" title="Enlazar permanentemente con este título">¶</a></h2>
<p>A los optimizadores que utilizan técnicas basadas en gradientes se les puede suministrar un gradiente definido por el usuario que va a ser usado en vez del gradiente definido por defecto que normalmente es calculado mediante una diferencia finita. Los gradientes pueden ser pasados indirectamente a través del optimizador mediante su parámetro <code class="docutils literal notranslate"><span class="pre">gradient</span></code>.</p>
<p>Como el uso de un gradiente suministrado por el usuario fue explicado en el tutorial Monitoreo de la convergencia de VQE simplemente haré referencia a el. También el tutorial <a class="reference internal" href="../operators/02_gradients_framework.html"><span class="doc">Estructura de los gradientes</span></a> tiene mucho más material acerca de los gradientes.</p>
</div>
<div class="section" id="Quantum-Instance-y-simulación-avanzada">
<h2>Quantum Instance y simulación avanzada<a class="headerlink" href="#Quantum-Instance-y-simulación-avanzada" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Aunque puede que estés familiarizado con pasar un QuantumInstance creado a partir de un <code class="docutils literal notranslate"><span class="pre">statevector_simulator</span></code>, un <code class="docutils literal notranslate"><span class="pre">qasm_simulator</span></code> o un backend de dispositivo real, también es posible usar los modos de simulación avanzados de Aer cuando apliquen. Por ejemplo, podemos usar el método <a class="reference internal" href="../simulators/7_matrix_product_state_method.html"><span class="doc">Matrix Product State</span></a> de Aer, que tiene potencial de ser escalable a un mayor numero de qubits.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aqua_globals</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">seed</span>

<span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">QasmSimulator</span>
<span class="n">quantum_instance</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">QasmSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;matrix_product_state&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">rotation_blocks</span><span class="o">=</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="o">=</span><span class="s1">&#39;cz&#39;</span><span class="p">)</span>
<span class="n">slsqp</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">H2_op</span><span class="p">,</span> <span class="n">var_form</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">slsqp</span><span class="p">,</span> <span class="n">quantum_instance</span><span class="o">=</span><span class="n">qi</span><span class="p">,</span> <span class="n">include_custom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;cost_function_evals&#39;: 72,
    &#39;eigenstate&#39;: {&#39;01&#39;: 1008, &#39;10&#39;: 16},
    &#39;eigenvalue&#39;: (-1.8572750175597519+0j),
    &#39;optimal_parameters&#39;: {   Parameter(θ[0]): 4.296520463599476,
                              Parameter(θ[6]): -4.717618128585369,
                              Parameter(θ[7]): 0.3602072910298268,
                              Parameter(θ[4]): -2.5983258956331645,
                              Parameter(θ[5]): 1.568326000491598,
                              Parameter(θ[3]): 6.092947836794945,
                              Parameter(θ[2]): 0.5470754235069875,
                              Parameter(θ[1]): 4.426962139199476},
    &#39;optimal_point&#39;: array([ 4.29652046,  4.42696214,  0.54707542,  6.09294784, -2.5983259 ,
        1.568326  , -4.71761813,  0.36020729]),
    &#39;optimal_value&#39;: -1.8572750175597519,
    &#39;optimizer_evals&#39;: 72,
    &#39;optimizer_time&#39;: 1.2383882999420166}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.23.1</td></tr><tr><td>Terra</td><td>0.16.1</td></tr><tr><td>Aer</td><td>0.7.1</td></tr><tr><td>Ignis</td><td>0.5.1</td></tr><tr><td>Aqua</td><td>0.8.1</td></tr><tr><td>IBM Q Provider</td><td>0.11.1</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.6.1 |Continuum Analytics, Inc.| (default, May 11 2017, 13:09:58)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]</td></tr><tr><td>OS</td><td>Linux</td></tr><tr><td>CPUs</td><td>1</td></tr><tr><td>Memory (Gb)</td><td>5.827335357666016</td></tr><tr><td colspan='2'>Tue Nov 17 15:48:57 2020 EST</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2020.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="05_iqpe_from_vqe.html" class="btn btn-neutral float-right" title="IQPE y la evolución del estado de salida de VQE" accesskey="n" rel="next">Next <img src="../../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="03_vqe_simulation_with_noise.html" class="btn btn-neutral" title="VQE en el simulador Aer con ruido" accesskey="p" rel="prev"><img src="../../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Qiskit Development Team.
      Actualizado por última vez en 2021/03/30.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Uso avanzado del VQE</a><ul>
<li><a class="reference internal" href="#Punto-inicial">Punto inicial</a></li>
<li><a class="reference internal" href="#Valor-Esperado">Valor Esperado</a></li>
<li><a class="reference internal" href="#Gradiente">Gradiente</a></li>
<li><a class="reference internal" href="#Quantum-Instance-y-simulación-avanzada">Quantum Instance y simulación avanzada</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
         <script src="../../_static/jquery.js"></script>
         <script src="../../_static/underscore.js"></script>
         <script src="../../_static/doctools.js"></script>
         <script src="../../_static/language_data.js"></script>
         <script src="../../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
         <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
     

  

  <script type="text/javascript" src="../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://quantum-computing.ibm.com/" target="_blank">IBM Quantum Experience</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>