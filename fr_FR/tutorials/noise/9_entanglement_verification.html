


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr-FR" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr-FR" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Vérification de l’intrication &mdash; Documentation Qiskit 0.24.1</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme-override.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-variables.ade9f9d55df9d2893fc676ecd59723a1.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Tutoriels sur les algorithmes" href="../algorithms/index.html" />
    <link rel="prev" title="Tomographie quantique" href="8_tomography.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://quantum-computing.ibm.com/" target="_blank">IBM Quantum Dashboard</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="rst-current-version-label">French</span>
    <span class="rst-versions-dropdown-icon"></span>
  </span>
  <div class="rst-other-versions">
    
    <dl>
      <dt>Langues</dt>
      
        <dd><a class="version" href="/documentation/tutorials/noise/9_entanglement_verification.html">English</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ja_JP/tutorials/noise/9_entanglement_verification.html">Japanese</a></dd>
      
        <dd><a class="version" href="/documentation/locale/de_DE/tutorials/noise/9_entanglement_verification.html">German</a></dd>
      
        <dd><a class="version" href="/documentation/locale/ko_KR/tutorials/noise/9_entanglement_verification.html">Korean</a></dd>
      
        <dd><a class="version" href="/documentation/locale/pt_BR/tutorials/noise/9_entanglement_verification.html">Portuguese, Brazilian</a></dd>
      
        <dd><a class="version" href="/documentation/locale/fr_FR/tutorials/noise/9_entanglement_verification.html">French</a></dd>
      
    </dl>
    
  </div>
  <script>
    jQuery('.version').click((evt) => {
      const hash = window.location.hash
      const complete_url = evt.target.href + hash
      window.location = complete_url
      evt.preventDefault()
    })
  </script>
</div>

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../qc_intro.html">L'informatique quantique en bref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation de Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Démarrer avec Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the_elements.html">Les éléments de Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_strategy.html">Stratégie de développement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_to_qiskit.html">Contribuer à Qiskit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration locale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Questions fréquentes</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutoriels</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../circuits/index.html">Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../circuits_advanced/index.html">Circuits avancés</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulators/index.html">Simulateurs de haute performance</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Analyse des erreurs des systèmes quantiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/index.html">Algorithmes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operators/index.html">Opérateurs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimization/index.html">Optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finance/index.html">Finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chemistry/index.html">Chimie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine_learning/index.html">Apprentissage Automatique (Machine Learning)</a></li>
</ul>
<p class="caption"><span class="caption-text">Bibliothèques</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/circuit_library.html">Bibliothèque de circuits</a></li>
</ul>
<p class="caption"><span class="caption-text">Références de l'API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/terra.html">Qiskit Terra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aer.html">Qiskit Aer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ignis.html">Qiskit Ignis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/aqua.html">Qiskit Aqua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/ibmq-provider.html">Fournisseur de plateforme IBM</a></li>
</ul>
<p class="caption"><span class="caption-text">Résolution de problème</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://quantum-computing.ibm.com/docs/cloud/errors">Code d'erreur de l'API IBM Quantum</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="index.html">Tutoriels sur l’analyse des erreurs des systèmes quantiques</a> &gt;</li>
        
      <li>Vérification de l’intrication</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/noise/9_entanglement_verification.ipynb" rel="nofollow"><img src="../../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cette page a été générée à partir de <a class="reference external" href="https://github.com/Qiskit/qiskit-tutorials/blob/master/tutorials/noise/9_entanglement_verification.ipynb">tutorials/noise/9_entanglement_verification.ipynb</a>.</p>
<p>Exécuter en mode interactif dans le <a class="reference external" href="https://quantum-computing.ibm.com/jupyter/tutorial/noise/9_entanglement_verification.ipynb">IBM Quantum lab</a>.</p>
</div>
<div class="section" id="Vérification-de-l'intrication">
<h1>Vérification de l’intrication<a class="headerlink" href="#Vérification-de-l'intrication" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="Introduction-à-l'état-GHZ">
<h2>Introduction à l’état GHZ<a class="headerlink" href="#Introduction-à-l'état-GHZ" title="Lien permanent vers ce titre">¶</a></h2>
<p><strong>L’État Greenberger-Horne-Zeilinger (GHZ)</strong> est un état intriqué à <span class="math notranslate nohighlight">\(n\)</span>-qubit que l’on peut. définir par le vecteur d’état suivant :</p>
<div class="math notranslate nohighlight">
\[|{\rm GHZ} \rangle = \frac{|0 \rangle ^{\otimes n} + |1 \rangle ^{\otimes n}}{\sqrt{2}} , n &gt; 2\]</div>
<p>La caractérisation de l’état GHZ est très utile pour évaluer les interactions multi-qubits, dont la robustesse est une clé du développement d’ordinateurs quantiques à grande échelle.</p>
</div>
<div class="section" id="Caractérisation-d'un-état-quantique">
<h2>Caractérisation d’un état quantique<a class="headerlink" href="#Caractérisation-d'un-état-quantique" title="Lien permanent vers ce titre">¶</a></h2>
<p>Tout état quantique mixte peut être identifié par une matrice de densité, définie comme $ <span class="math">\rho `= :nbsphinx-math:</span>Sigma`<em>{i} p_i |:nbsphinx-math:`psi`</em>{i} <span class="math">\rangle `:nbsphinx-math:</span>langle <cite>:nbsphinx-math:</cite>psi`_{i}| $, où <span class="math notranslate nohighlight">\(|\psi_{i} \rangle\)</span> sont les états quantiques purs formant le mélange et <span class="math notranslate nohighlight">\(0 &lt; p_i \le 1\)</span>, <span class="math notranslate nohighlight">\(\Sigma_{i} p_i = 1\)</span> sont les probabilités classiques d’être dans l’état <span class="math notranslate nohighlight">\(|\psi_{i} \rangle\)</span>. Nous dénotons la matrice de densité pure d’un état de GHZ idéal par <span class="math notranslate nohighlight">\(\rho_{p} \equiv |{\rm GHZ} \rangle \langle {\rm GHZ}|\)</span>. Nous voulons voir à quel point cette matrice est proche de la matrice de densité d’un Etat GHZ telle qu’elle est produite dans une expérience, <span class="math notranslate nohighlight">\(\rho_{T}\)</span>. Une méthode pour quantifier cette similitude est de calculer la fidélité entre les états, <span class="math notranslate nohighlight">\(F(\rho_{p},\rho_{T})\)</span></p>
<div class="math notranslate nohighlight">
\[F = \Big[ Tr \sqrt{\sqrt{\rho_{p}}\rho_{T}\sqrt{\rho_{p}}} \Big] ^{2}\]</div>
<p>Le but de ce tutoriel est double: nous allons explorer des façons de caractériser l’état GHZ, et des façons dont nous pouvons utiliser la bibliothèque lgnis et ses outils d’atténuation des erreurs pour augmenter la fidélité de lecture, indépendamment de la méthode de caractérisation utilisée</p>
<p>Avant d’aller plus loin, importons tout ce dont nous aurons besoin à partir du Qiskit de base:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">IBMQ</span><span class="p">,</span> <span class="n">execute</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">QuantumRegister</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.ibmq</span> <span class="kn">import</span> <span class="n">least_busy</span>
<span class="kn">from</span> <span class="nn">qiskit.tools.monitor</span> <span class="kn">import</span> <span class="n">job_monitor</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">Parameter</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">noise</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">quantum_info</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">visualization</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<p>Les deux fonctions suivantes sont issues dl’ignis. La première concerne la technique générale d’atténuation des erreurs, et la seconde est spécifique pour la tomographie quantique</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.mitigation.measurement</span> <span class="kn">import</span> <span class="p">(</span><span class="n">complete_meas_cal</span><span class="p">,</span> <span class="n">tensored_meas_cal</span><span class="p">,</span>
                                                 <span class="n">CompleteMeasFitter</span><span class="p">,</span> <span class="n">TensoredMeasFitter</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.tomography</span> <span class="kn">import</span> <span class="n">state_tomography_circuits</span><span class="p">,</span> <span class="n">StateTomographyFitter</span>
</pre></div>
</div>
</div>
<p>L’importation suivante depuis le package <code class="docutils literal notranslate"><span class="pre">entanglement</span></code> contient les informations nécessaires pour créer, paralléliser et analyser les circuits d’état GHZ</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.parallelize</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.linear</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.analysis</span> <span class="kn">import</span> <span class="n">Plotter</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Préparation-d'un-état-GHZ">
<h2>Préparation d’un état GHZ<a class="headerlink" href="#Préparation-d'un-état-GHZ" title="Lien permanent vers ce titre">¶</a></h2>
<p>Voyons d’abord comment préparer un État GHZ:</p>
<p>Disons que nous avons un système de <span class="math notranslate nohighlight">\(n\)</span> qubits, tous préparés dans l’état :math:` <a href="#id1"><span class="problematic" id="id2">|</span></a>0rangle`:</p>
<div class="math notranslate nohighlight">
\[|\psi \rangle = |00...0\rangle\]</div>
<p>Nous appliquons une porte Hadamard au premier qubit: <span class="math notranslate nohighlight">\(|0\rangle \longrightarrow \frac{1}{ \sqrt{2}} (| 0\rangle + | 1\rangle)\)</span>. Notre état se présente maintenant comme suit:</p>
<div class="math notranslate nohighlight">
\[|\psi \rangle = \frac{|00...0\rangle + |10...0\rangle}{\sqrt{2}}\]</div>
<p>Sur cet état, l’application d’une séquence de <span class="math notranslate nohighlight">\(n-1\)</span> CNOT entre le <span class="math notranslate nohighlight">\(n^{ieme}\)</span> et le <span class="math notranslate nohighlight">\((n+1)^{ieme}\)</span> qubits pour <span class="math notranslate nohighlight">\(n = 0 \ldots n-1\)</span> laisse le qubit <span class="math notranslate nohighlight">\(n+1\)</span> à <span class="math notranslate nohighlight">\(|0\rangle\)</span> si le <span class="math notranslate nohighlight">\(n^{th}\)</span> est dans l’état <span class="math notranslate nohighlight">\(|0\rangle\)</span>, et <span class="math notranslate nohighlight">\(|1\rangle\)</span> si le <span class="math notranslate nohighlight">\(n^{ieme}\)</span> qubit est en <span class="math notranslate nohighlight">\(|1\rangle\)</span>, créant ainsi l’état GHZ:</p>
<div class="math notranslate nohighlight">
\[|GHZ \rangle = \frac{|00...0\rangle + |11...1\rangle}{\sqrt{2}} \equiv \frac{|0 \rangle ^{\otimes n} + |1 \rangle ^{\otimes n}}{\sqrt{2}}\]</div>
<p>La fonction suivante crée ce circuit « linéaire » qui peut mesurer l’état GHZ:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#creating a 5 qubit GHZ state</span>
<span class="n">circ_simple</span> <span class="o">=</span> <span class="n">get_ghz_simple</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">measure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_simple</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_8_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_8_0.png" />
</div>
</div>
</div>
<div class="section" id="Caractérisation,-Partie-I">
<h2>Caractérisation, Partie I<a class="headerlink" href="#Caractérisation,-Partie-I" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="Coherence-quantique-multiple-(MQC)">
<h3>Coherence quantique multiple (MQC)<a class="headerlink" href="#Coherence-quantique-multiple-(MQC)" title="Lien permanent vers ce titre">¶</a></h3>
<p>La Cohérence Quantique Multiple (MQC) fonctionne en faisant la préparation préliminaire d’un état GHZ de <span class="math notranslate nohighlight">\(n\)</span> qubits et opérant une rotation des états des qubits autour de l’axe z par une phase :math:` phi`. Après cela, nous appliquons une porte X, c’est-à-dire une impulsion de <span class="math notranslate nohighlight">\(\pi\)</span> autour de l’axe x. Ensuite, nous appliquons l’inverse des opérations que nous avons initialement appliquées pour obtenir l’état GHZ. Dans une situation idéale, l’état final est <span class="math notranslate nohighlight">\(|\psi \rangle = \frac{|0\rangle ^{ \otimes n} + e^{i n \phi} |1 \rangle^{\otimes n}}{\sqrt{2}}\)</span>. Idéalement nous pouvons observer la phase obtenue en projetant <span class="math notranslate nohighlight">\(| \psi \rangle\)</span> sur l’état $|0 <span class="math">\rangle`^ {:nbsphinx-math:</span>otimes <a href="#id1"><span class="problematic" id="id2">`</span></a>n} $. Cette technique est la conséquence d’une séquence d’écho et il a été démontré qu’elle améliore considérablement la fidélité au cours de la lecture.</p>
<p>La fonction ci-dessous crée un circuit MQC linéaire. Comme pour chaque circuit ici, vous pouvez changer l’argument <code class="docutils literal notranslate"><span class="pre">full_measurement</span></code> pour basculer entre la mesure complète de tous les qubits ou la mesure de seulement le qubit de contrôle. La mesure complète donne les résultats les plus précis, mais pour plus de 7 qubits, il est recommandé de la définir à false et d’observer uniquement les oscillations entre les états <code class="docutils literal notranslate"><span class="pre">0</span></code> et <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_mqc</span> <span class="o">=</span> <span class="n">get_ghz_mqc_para</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span> <span class="n">full_measurement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_mqc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_11_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_11_0.png" />
</div>
</div>
<p>Après avoir exécuté les expériences sur ce circuit MQC, nous pouvons choisir un état pour observer les oscillations lorsque nous balayons <span class="math notranslate nohighlight">\(\phi\)</span> de <span class="math notranslate nohighlight">\(0\)</span> à <span class="math notranslate nohighlight">\(2 \pi\)</span>. Notre signal en théorie devrait suivre <span class="math notranslate nohighlight">\(S(\phi) = \frac{1}{2}(1+cos(n \phi))\)</span>. Nous effectuons ensuite une Transformation de Fourier Discrete (DFT: <span class="math notranslate nohighlight">\(I_{v}=(1/N)|\Sigma_{\phi}e^{iv\phi}S(\\phi)\)</span>) pour extraire la fidélité de l’état, défini par les limites <span class="math notranslate nohighlight">\(2\sqrt{I_{n}} \leq F \leq \sqrt{I_{0}/2}+ \sqrt{I_{n}}\)</span>; si désiré, une valeur réelle pour la fidélité peut être obtenue : <span class="math notranslate nohighlight">\(F = \frac{1}{2}(P_{00...0}+P_{11...1})+\sqrt{I_{n}})\)</span> (arXiv:1905. 5720).</p>
</div>
<div class="section" id="Oscillations-de-parité">
<h3>Oscillations de parité<a class="headerlink" href="#Oscillations-de-parité" title="Lien permanent vers ce titre">¶</a></h3>
<p>La méthode suivante que nous utilisons pour caractériser l’état de GHZ s’appuie sur les oscillations de parité. Après avoir préparé un état GHZ, nous appliquons une combinaison de rotations sur les axes x et y pour créer différents états de superposition en fonction de <span class="math notranslate nohighlight">\(\phi\)</span>: <span class="math notranslate nohighlight">\(U(\phi) = \otimes_{j}^{N} e^{i\frac{\pi}{4}(cos(\phi)\sigma_{x}^{j}+sin(\phi)\sigma_{y}^{j})}\)</span>. Nous mesurons ensuite la valeur attendue <span class="math notranslate nohighlight">\(\langle \otimes_{j}^{N} \sigma_{z}^{j} \rangle_{\phi}\)</span> en fonction de <span class="math notranslate nohighlight">\(\phi\)</span>, qui en théorie devrait conduire à des oscillations de parité entre 1 et -1.</p>
<p>La fonction suivante génère un circuit qui est l’équivalent en oscillation de parité du circuit MQC indiqué ci-dessus</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_po</span> <span class="o">=</span> <span class="n">get_ghz_po_para</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_po</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_15_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_15_0.png" />
</div>
</div>
<p>Nous pouvons obtenir la fidélité pour les oscillations de parité :math:` <a href="#id4"><span class="problematic" id="id5">S_</span></a> { phi } ` de :math:` F = frac{1}{2}(P_{00…0}+ P_{11…1}+ C) <cite>, où :math:</cite> C <cite>, la cohérence est définie comme :math:</cite> 2sqrt { I_{n}} <a href="#id1"><span class="problematic" id="id2">`</span></a>, suivant la même convention pour la DFT que pour la méthode MQC.</p>
</div>
<div class="section" id="Tomographie">
<h3>Tomographie<a class="headerlink" href="#Tomographie" title="Lien permanent vers ce titre">¶</a></h3>
<p>La tomographie mesure la matrice de densité en produisant de nombreux états nominalement identiques et en mesurant les instances d’état dans différentes bases. Le résultat idéal d’un état GHZ est de quatre éléments de matrice de densité égale aux 4 coins de la base du produit tensoriel, tous les autres éléments disparaissent. Bien que la fidélité puisse être facilement calculée par cette méthode, la méthode est lente (nécessite un nombre exponentiel de mesures par rapport à n), et devient très longue au delà de 7. Néanmoins, nous montrerons ci-dessous comment effectuer cette méthode car elle est pertinente pour un petit nombre de qubits.</p>
</div>
</div>
</div>
<div class="section" id="Parallélisation-des-circuits">
<h1>Parallélisation des circuits<a class="headerlink" href="#Parallélisation-des-circuits" title="Lien permanent vers ce titre">¶</a></h1>
<p>Les circuits « linéaires » ci-dessus conviennent pour effectuer des simulations, mais comment faire lorsque nous utilisons des dispositifs réels, où le système peut avoir une topologie arbitraire et diverses erreurs ? Nous ciblons spécifiquement le matériel réel ici, pas seulement la simulation Aer. Une technique pour réduire les effets du matériel réel est de paralléliser les portes CNOT et ainsi créer un circuit plus court. Cela peut être extrêmement bénéfique en termes d’efficacité et de fidélité. La classe <code class="docutils literal notranslate"><span class="pre">BConfig</span></code> du module <code class="docutils literal notranslate"><span class="pre">parallelize</span></code> fait justement cela.</p>
<p>Tout d’abord, nous devons configurer le backend optimal que nous voulons utiliser. Nous considérerons un backend de simulation, <code class="docutils literal notranslate"><span class="pre">ibmq_qasm_simulateur</span></code>, déguisé en un véritable appareil, <code class="docutils literal notranslate"><span class="pre">ibmq_16_melbourne</span></code> en utilisant un faux backend <code class="docutils literal notranslate"><span class="pre">FakeMelbourne</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">QasmSimulator</span>
<span class="kn">from</span> <span class="nn">qiskit.test.mock</span> <span class="kn">import</span> <span class="n">FakeMelbourne</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">QasmSimulator</span><span class="p">()</span>
<span class="n">backend_hardware</span> <span class="o">=</span> <span class="n">FakeMelbourne</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">noise</span></code> module, we can now define a noise model from <code class="docutils literal notranslate"><span class="pre">'ibmq_16_melbourne'</span></code> to “assign” to <code class="docutils literal notranslate"><span class="pre">'ibmq_qasm_simulator'</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">noise_model</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">NoiseModel</span><span class="o">.</span><span class="n">from_backend</span><span class="p">(</span><span class="n">backend_hardware</span><span class="p">)</span>
<span class="n">coupling_map</span> <span class="o">=</span> <span class="n">backend_hardware</span><span class="o">.</span><span class="n">_configuration</span><span class="o">.</span><span class="n">coupling_map</span>
<span class="n">basis_gates</span><span class="o">=</span><span class="n">noise_model</span><span class="o">.</span><span class="n">basis_gates</span>
</pre></div>
</div>
</div>
<p>Et là, nous l’avons. A partir de maintenant, dans le tutoriel, lors de l’utilisation d’un véritable appareil, pas d’une simulation, il suffit de mentionner le <code class="docutils literal notranslate"><span class="pre">noise_model</span></code> et <code class="docutils literal notranslate"><span class="pre">coupling_map</span></code>, et d’assigner le vrai dispositif à <code class="docutils literal notranslate"><span class="pre">backend</span></code>. Le simulateur utilisé à partir de maintenant n’est pas un substitut à l’exécution d’un véritable appareil.</p>
<p><code class="docutils literal notranslate"><span class="pre">BConfig</span></code> définit le cadre pour créer des circuits parallélisés. Initialisons un objet en prenant le device réel que nous venons de définir, et nommons le <code class="docutils literal notranslate"><span class="pre">protocirc</span></code>. Toutes nos expériences l’utiliseront :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">protocirc</span> <span class="o">=</span> <span class="n">BConfig</span><span class="p">(</span><span class="n">backend_hardware</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Atténuation-d'erreurs">
<h1>Atténuation d’erreurs<a class="headerlink" href="#Atténuation-d'erreurs" title="Lien permanent vers ce titre">¶</a></h1>
<p>Qiskit Ignis fournit des outils très précis pour prendre des données brutes et retourner les données calibrées. Pour ce faire, on obtient les données brutes, sous la forme d’un vecteur :math:` v_{raw}` et on obtient une matrice d’étalonnage <span class="math notranslate nohighlight">\(A\)</span>. La sortie est alors la solution au problème d’optimisation: :math:` <a href="#id6"><span class="problematic" id="id7">argmin_</span></a> { v_{cal}} | | Av_{cal}-v_{raw}| | ^{2}`</p>
</div>
<div class="section" id="Phase-d'expérimentation">
<h1>Phase d’expérimentation<a class="headerlink" href="#Phase-d'expérimentation" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="Étapes-préliminaires">
<h2>Étapes préliminaires<a class="headerlink" href="#Étapes-préliminaires" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les probabilités de mesurer <span class="math notranslate nohighlight">\(|0\rangle ^ { \otimes n }\)</span> et :math:` | 1rangle ^ { otimes n }` dans l’état GHZ sont importantes pour le calcul de la fidélité. Pour cela, nous devons exécuter le test suivant :</p>
<p>Nous commençons par définir les paramètres d’exécution standard :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span> <span class="c1">#numbers of shots in a given experiment</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#number of credits</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#number of qubits</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span> <span class="c1">#will help us easily define the state |00...00&gt;</span>
<span class="n">onecode</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="n">qn</span> <span class="c1">#will help us easily define the state |11...11&gt;</span>
<span class="n">sweep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="c1">#standard list of phase values we will sweep</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_simple</span><span class="p">,</span> <span class="n">qr</span><span class="p">,</span> <span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_simple</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">initial_layout</span><span class="p">)</span>
<span class="n">circ_simple</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{Qubit(QuantumRegister(5, &#39;q&#39;), 0): 1, Qubit(QuantumRegister(5, &#39;q&#39;), 1): 2, Qubit(QuantumRegister(5, &#39;q&#39;), 2): 0, Qubit(QuantumRegister(5, &#39;q&#39;), 3): 3, Qubit(QuantumRegister(5, &#39;q&#39;), 4): 13}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<pre style="word-wrap: normal;white-space: pre;background: #fff0;line-height: 1.1;font-family: &quot;Courier New&quot;,Courier,monospace">                        ░ ┌───┐ ░                               ░  ░       ┌─┐»
 q_0: ──────────────────░─┤ X ├─░───────────────────────────────░──░───────┤M├»
      ┌──────────┐      ░ └─┬─┘ ░ ┌──────────┐┌───┐┌──────────┐ ░  ░ ┌─┐   └╥┘»
 q_1: ┤ U2(0,pi) ├──■───░───■───░─┤ U2(0,pi) ├┤ X ├┤ U2(0,pi) ├─░──░─┤M├────╫─»
      └──────────┘┌─┴─┐ ░       ░ └──────────┘└─┬─┘└──────────┘ ░  ░ └╥┘┌─┐ ║ »
 q_2: ────────────┤ X ├─░───■───░───────────────┼───────────────░──░──╫─┤M├─╫─»
                  └───┘ ░ ┌─┴─┐ ░               │               ░  ░  ║ └╥┘ ║ »
 q_3: ──────────────────░─┤ X ├─░───────────────┼───────────────░──░──╫──╫──╫─»
                        ░ └───┘ ░               │               ░  ░  ║  ║  ║ »
 q_4: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
 q_5: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
 q_6: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
 q_7: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
 q_8: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
 q_9: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
q_10: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
q_11: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                                                │                     ║  ║  ║ »
q_12: ──────────────────────────────────────────┼─────────────────────╫──╫──╫─»
                        ░       ░ ┌──────────┐  │  ┌──────────┐ ░  ░  ║  ║  ║ »
q_13: ──────────────────░───────░─┤ U2(0,pi) ├──■──┤ U2(0,pi) ├─░──░──╫──╫──╫─»
                        ░       ░ └──────────┘     └──────────┘ ░  ░  ║  ║  ║ »
 c_0: ════════════════════════════════════════════════════════════════╩══╬══╬═»
                                                                         ║  ║ »
 c_1: ═══════════════════════════════════════════════════════════════════╩══╬═»
                                                                            ║ »
 c_2: ══════════════════════════════════════════════════════════════════════╩═»
                                                                              »
 c_3: ════════════════════════════════════════════════════════════════════════»
                                                                              »
 c_4: ════════════════════════════════════════════════════════════════════════»
                                                                              »
«
« q_0: ──────
«
« q_1: ──────
«
« q_2: ──────
«      ┌─┐
« q_3: ┤M├───
«      └╥┘
« q_4: ─╫────
«       ║
« q_5: ─╫────
«       ║
« q_6: ─╫────
«       ║
« q_7: ─╫────
«       ║
« q_8: ─╫────
«       ║
« q_9: ─╫────
«       ║
«q_10: ─╫────
«       ║
«q_11: ─╫────
«       ║
«q_12: ─╫────
«       ║ ┌─┐
«q_13: ─╫─┤M├
«       ║ └╥┘
« c_0: ═╬══╬═
«       ║  ║
« c_1: ═╬══╬═
«       ║  ║
« c_2: ═╬══╬═
«       ║  ║
« c_3: ═╩══╬═
«          ║
« c_4: ════╩═
«            </pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_simple</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_simple</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">,</span><span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">)</span>
<span class="c1"># job_simple = execute(circ_simple, backend, shots=shots, max_credits=max_credits,noise_model=noise_model, coupling_map=coupling_map, basis_gates=basis_gates)</span>

<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_simple</span><span class="p">)</span>
<span class="n">result_simple</span> <span class="o">=</span> <span class="n">job_simple</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">P0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">zerocode</span><span class="p">]</span>
<span class="n">P1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">onecode</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|00...0&gt;) = &#39;</span><span class="p">,</span><span class="n">P0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|11...1&gt;) = &#39;</span><span class="p">,</span><span class="n">P1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
P(|00...0&gt;) =  0.2734375
P(|11...1&gt;) =  0.26171875
</pre></div></div>
</div>
<p>Maintenant, avec l’atténuation des erreurs :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs_simple</span><span class="p">,</span> <span class="n">state_labels_simple</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_simple_em</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs_simple</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                     <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_simple_em</span><span class="p">)</span>
<span class="n">meas_result</span> <span class="o">=</span> <span class="n">job_simple_em</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result</span><span class="p">,</span><span class="n">state_labels_simple</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="n">result_simple_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">result_simple</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_simple_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">zerocode</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.3594873732569084
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">P0_m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">zerocode</span><span class="p">]</span>
<span class="n">P1_m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_simple_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()[</span><span class="n">onecode</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|00...0&gt;) error mitigated = &#39;</span><span class="p">,</span><span class="n">P0_m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(|11...1&gt;) error mitigated = &#39;</span><span class="p">,</span><span class="n">P1_m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
P(|00...0&gt;) error mitigated =  0.3594873732569084
P(|11...1&gt;) error mitigated =  0.3418736739583168
</pre></div></div>
</div>
<p>Nous allons charger ces valeurs dans un dictionnaire pour pouvoir évaluer la fidélité par la suite :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;P0&#39;</span><span class="p">:</span> <span class="n">P0</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="n">P1</span><span class="p">,</span> <span class="s1">&#39;P0_m&#39;</span><span class="p">:</span> <span class="n">P0_m</span><span class="p">,</span> <span class="s1">&#39;P1_m&#39;</span><span class="p">:</span><span class="n">P1_m</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Partie-1-:-MQC">
<h2>Partie 1 : MQC<a class="headerlink" href="#Partie-1-:-MQC" title="Lien permanent vers ce titre">¶</a></h2>
<p>Nous récupérons maintenant un circuit MQC parallèle pour le système de n qubit</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span> <span class="c1">#numbers of shots in a given experiment</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#number of credits</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#number of qubits</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span> <span class="c1">#will help us easily define the state |00...00&gt;</span>
<span class="n">sweep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="c1">#standard list of phase values we will sweep</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="n">circ</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span><span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_mqc_para</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">circ_total_mqc</span> <span class="o">=</span> <span class="p">[</span><span class="n">circ</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="n">t</span><span class="p">})</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sweep</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wall time: 1.46 s
</pre></div></div>
</div>
<p>Nous exécutons maintenant l’expérience MQC :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_exp_mqc</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_total_mqc</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">,</span>
                      <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span><span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_exp_mqc</span><span class="p">)</span>
<span class="n">result_exp_mqc</span> <span class="o">=</span> <span class="n">job_exp_mqc</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<p>Nous allons maintenant tracer la quantité d’occurrences mesurées pour <span class="math notranslate nohighlight">\(| 0 \rangle ^ { \otimes n }\)</span> en fonction de la phase. Il est important de noter que lors de l’utilisation d’un circuit paramétré comme celui ici, la méthode <code class="docutils literal notranslate"><span class="pre">get_counts()</span></code> accepte un <strong>index</strong> et non un <strong>circuit</strong>. Dans tout autre type d’expérience, <code class="docutils literal notranslate"><span class="pre">get_counts()</span></code> accepte un ** circuit**.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">zeros</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_exp_mqc</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="n">zerocode</span><span class="p">]</span> <span class="k">if</span>
          <span class="n">zerocode</span> <span class="ow">in</span> <span class="n">result_exp_mqc</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))</span> <span class="p">]</span> <span class="c1">#notice the important difference with proto2; takes only the index, not the actual circuit</span>
<span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;mqc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">zeros</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_47_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_47_0.png" />
</div>
</div>
<p>Now we get started on error mitigation. We create an identical quantum register and use complete_meas_cal from Ignis, to create circuits for calibrated measurements to be excecuted, and a calibration matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs_mqc</span><span class="p">,</span> <span class="n">state_labels_mqc</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span> <span class="c1">#from Ignis</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_cal_mqc</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs_mqc</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                     <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span><span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_cal_mqc</span><span class="p">)</span>
<span class="n">meas_result_mqc</span> <span class="o">=</span> <span class="n">job_cal_mqc</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter_mqc</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result_mqc</span><span class="p">,</span><span class="n">state_labels_mqc</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="c1"># print(meas_fitter.cal_matrix) #uncomment this to see how close the calibration matrix is to the calibration matrix</span>
</pre></div>
</div>
</div>
<p>Enfin, nous avons nos résultats avec les erreurs atténuées :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_exp_em</span> <span class="o">=</span> <span class="n">meas_fitter_mqc</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">result_exp_mqc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Nous pouvons voir comment les résultats utilisant l’atténuation d’erreur produisent une fidélité beaucoup plus grande que les données brutes</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">zeros_m</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">result_exp_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="n">zerocode</span><span class="p">]</span> <span class="k">if</span>
          <span class="n">zerocode</span> <span class="ow">in</span> <span class="n">result_exp_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))</span> <span class="p">]</span>

<span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;mqc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">zeros</span><span class="p">,</span><span class="n">zeros_m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_55_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_55_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;mqc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_fourier_info</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">sweep</span><span class="p">,</span><span class="n">zeros</span><span class="p">,</span><span class="n">zeros_m</span><span class="p">,</span><span class="n">p_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Upper/Lower raw fidelity bounds =  0.514  +/-  0.005  ||  0.421  +/- 0.004
Upper/Lower error mitigated fidelity bounds =  0.591  +/-  0.006  ||  0.516  +/-  0.005
Raw fidelity =  0.561  +/-  0.006
Mitigated fidelity =  0.609  +/-  0.006
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;I0&#39;: (0.18463134765625+0j),
 &#39;In&#39;: (0.04432759177708011+0.0006539034107776532j),
 &#39;I0_m&#39;: (0.22211095961766059+0j),
 &#39;In_m&#39;: (0.06659122106161491+0.0011647793472158757j),
 &#39;LB&#39;: 0.4211052817490912,
 &#39;UB&#39;: 0.5143875859156403,
 &#39;LB_m&#39;: 0.5161449685614564,
 &#39;UB_m&#39;: 0.5913223602129336,
 &#39;F&#39;: 0.5612331644821582,
 &#39;F_m&#39;: 0.6087530078883407}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_56_2.png" src="../../_images/tutorials_noise_9_entanglement_verification_56_2.png" />
</div>
</div>
<p>Nous traçons maintenant la DFT et comparons les hauteurs des pics pour donner des bornes pour la fidélité</p>
<p>Le bootstrap statistique a permis de constater que l’erreur sur ces mesures est au plus de 1,5% (arXiv 1905.05720), de sorte que ces résultats se situent à l’intérieur des limites d’erreur, malgré la fidélité légèrement supérieure à la limite haute, et montrent comment l’atténuation des erreurs augmente considérablement la fidélité</p>
</div>
<div class="section" id="Partie-2-:-Oscillation-de-parité">
<h2>Partie 2 : Oscillation de parité<a class="headerlink" href="#Partie-2-:-Oscillation-de-parité" title="Lien permanent vers ce titre">¶</a></h2>
<p>Nous récupérons maintenant un circuit de Parity Oscillation parallélisé pour un système à n qubits, et nous exécutons des expériences de la même façon que nous l’avons fait au MQC.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span>
<span class="n">sweep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%time</span>
<span class="n">circ</span><span class="p">,</span> <span class="p">[</span><span class="n">theta</span><span class="p">,</span><span class="n">thetaneg</span><span class="p">]</span> <span class="p">,</span> <span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_po_para</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>

<span class="n">circ_total</span> <span class="o">=</span> <span class="p">[</span><span class="n">circ</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="n">t</span><span class="p">,</span> <span class="n">thetaneg</span><span class="p">:</span><span class="o">-</span><span class="n">t</span><span class="p">})</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sweep</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wall time: 1.49 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_exp</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_total</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">,</span>
                  <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_exp</span><span class="p">)</span>
<span class="n">result_exp</span> <span class="o">=</span> <span class="n">job_exp</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<p>Nous construisons à présent a matrice :math:` otimes _{j}^{N} sigma_z ^{j}` pour l’instruction, bien que cette méthode soit déjà prise en compte dans la méthode suivante: <code class="docutils literal notranslate"><span class="pre">entanglement.analysis.composite_pauli_z_expvalue</span> <span class="pre">()</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">composite_sigma_z</span> <span class="o">=</span> <span class="n">sigma_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">qn</span><span class="p">):</span>
    <span class="n">composite_sigma_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">composite_sigma_z</span><span class="p">,</span><span class="n">sigma_z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Maintenant nous voulons nous assurer que notre liste de compteurs est correctement ordonnée afin qu’elle coïncide avec les états des <span class="math notranslate nohighlight">\(\otimes _{j}^{N} \sigma_z ^{j}\)</span>, de sorte que le calcul de <span class="math notranslate nohighlight">\(\langle \otimes _{j}^{N} \sigma_z^{j} \rangle\)</span> sera aussi simple que de prendre le produit à points de cette liste ordonnée avec la diagonale de <span class="math notranslate nohighlight">\(\otimes _{j}^{N} \sigma_z ^{j}\)</span>. La fonction <code class="docutils literal notranslate"><span class="pre">composite_pauli_z_expvalue</span></code> fait exactement cela ; elle prend un circuit et ordonne correctement le nombre de vecteurs d’état. Nous pouvons tracer ce produit en tant que fonction de <span class="math notranslate nohighlight">\(\phi\)</span> pour observer les oscillations de parité.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.analysis</span> <span class="kn">import</span> <span class="n">composite_pauli_z_expvalue</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">composite_pauli_z_expvalue</span><span class="p">(</span><span class="n">result_exp</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">qn</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_68_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_68_0.png" />
</div>
</div>
<p>Maintenant, pour l’atténuation standard des erreurs :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs</span><span class="p">,</span> <span class="n">state_labels</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_cal</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                  <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_cal</span><span class="p">)</span>
<span class="n">meas_result</span> <span class="o">=</span> <span class="n">job_cal</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result</span><span class="p">,</span><span class="n">state_labels</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="n">result_exp_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">result_exp</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_m</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">shots</span><span class="p">)</span><span class="o">*</span><span class="n">composite_pauli_z_expvalue</span><span class="p">(</span><span class="n">result_exp_em</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">qn</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sin_plotter</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y_m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_74_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_74_0.png" />
</div>
</div>
<p>Nous pouvons voir comment l’atténuation des erreurs améliore considérablement notre mesure (beaucoup plus en PO qu’au MQC). Quantifions- ceci en utilisant la même méthode DFT que nous avons utilisée dans le MQC, et calculant les fidélités réelles:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Plotter</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_fourier_info</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">sweep</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y_m</span><span class="p">,</span><span class="n">p_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Raw fidelity =  0.414  +/-  0.004
Mitigated fidelity =  0.621  +/-  0.006
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;In&#39;: (-0.1461775086184215-0.002569102936642498j),
 &#39;In_m&#39;: (-0.26997809795388583-0.004625032477291818j),
 &#39;F&#39;: 0.4137782081593052,
 &#39;F_m&#39;: 0.6206982346937819}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_76_2.png" src="../../_images/tutorials_noise_9_entanglement_verification_76_2.png" />
</div>
</div>
<p>Comme nous le voyons, la fidélité brute est beaucoup plus faible que ce qui est obtenu avec les Oscillations MQC ou de parité, mais le résultat d’atténuation des erreurs est à peu près le même.</p>
</div>
<div class="section" id="Partie-3:-Tomographie">
<h2>Partie 3: Tomographie<a class="headerlink" href="#Partie-3:-Tomographie" title="Lien permanent vers ce titre">¶</a></h2>
<p>La première étape de cette expérience est de passer un état GHZ simple <em>sans</em> opération de mesure. De plus, le circuit ne peut pas être transpilé ; l’argument <code class="docutils literal notranslate"><span class="pre">transpiled</span></code> dans la méthode <code class="docutils literal notranslate"><span class="pre">getGHZChecker</span> <span class="pre">()</span></code> peut être activé et désactivé comme indiqué</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">max_credits</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">qn</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">zerocode</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="n">qn</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">circ_total</span><span class="p">,</span> <span class="n">initial_layout</span> <span class="o">=</span> <span class="n">protocirc</span><span class="o">.</span><span class="n">get_ghz_layout</span><span class="p">(</span><span class="n">qn</span><span class="p">,</span><span class="n">transpiled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Nous avons maintenant un backend simulé par <code class="docutils literal notranslate"><span class="pre">Aer</span></code> pour obtenir les quantités théoriques des états vectoriels</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_exp</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">circ_total</span><span class="p">,</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">max_credits</span><span class="o">=</span><span class="n">max_credits</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_exp</span><span class="p">)</span>
<span class="n">result_exp</span> <span class="o">=</span> <span class="n">job_exp</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">psi_exp</span> <span class="o">=</span> <span class="n">result_exp</span><span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">circ_total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<p>Le code suivant exécute des expériences de tomographie sur le circuit que nous avons défini en premier, qui est ensuite comparé au vecteur d’état théorique pour générer une matrice de densité</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qst</span> <span class="o">=</span> <span class="n">state_tomography_circuits</span><span class="p">(</span><span class="n">circ_total</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">qst</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">initial_layout</span><span class="o">=</span><span class="n">initial_layout</span><span class="p">,</span><span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tomo</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">qst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>De là, nous pouvons obtenir la fidélité, bien que cette méthode ne soit pas aussi robuste que celle à laquelle nous arriverons à la fin :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">F</span> <span class="o">=</span> <span class="n">quantum_info</span><span class="o">.</span><span class="n">state_fidelity</span><span class="p">(</span><span class="n">psi_exp</span><span class="p">,</span><span class="n">tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FATAL: Cannot solve SDPs with &gt; 2x2 matrices without linked blas+lapack libraries
Install blas+lapack and re-compile SCS with blas+lapack library locations
ERROR: init_cone failure
Failure:could not initialize work
</pre></div></div>
</div>
<p>…And now for error mitigation…</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">qubit_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">qn</span><span class="p">)</span>
<span class="n">meas_calibs</span><span class="p">,</span> <span class="n">state_labels</span> <span class="o">=</span> <span class="n">complete_meas_cal</span><span class="p">(</span><span class="n">qubit_list</span><span class="o">=</span><span class="n">qubit_list</span><span class="p">,</span> <span class="n">qr</span><span class="o">=</span><span class="n">qr</span><span class="p">,</span> <span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">job_c</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">meas_calibs</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                  <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_c</span><span class="p">)</span>
<span class="n">meas_result</span> <span class="o">=</span> <span class="n">job_c</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meas_fitter</span> <span class="o">=</span> <span class="n">CompleteMeasFitter</span><span class="p">(</span><span class="n">meas_result</span><span class="p">,</span><span class="n">state_labels</span><span class="p">,</span><span class="n">circlabel</span><span class="o">=</span><span class="s1">&#39;mcal&#39;</span><span class="p">)</span>
<span class="n">result_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_em</span> <span class="o">=</span> <span class="n">meas_fitter</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
<span class="n">tomo_em</span> <span class="o">=</span> <span class="n">StateTomographyFitter</span><span class="p">(</span><span class="n">result_em</span><span class="p">,</span> <span class="n">qst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, using <code class="docutils literal notranslate"><span class="pre">qiskit.visualization</span></code>, we can plot the raw density matrix, real, and imiginary parts being on separate plots,…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_state_city</span><span class="p">(</span><span class="n">tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span><span class="s2">&quot;city&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_94_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_94_0.png" />
</div>
</div>
<p>And also the error mitigated density matrix,…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_state_city</span><span class="p">(</span><span class="n">tomo_em</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span><span class="s2">&quot;city&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_noise_9_entanglement_verification_96_0.png" src="../../_images/tutorials_noise_9_entanglement_verification_96_0.png" />
</div>
</div>
<p>Les matrices de densité réelles peuvent être obtenues à l’aide de la méthode <code class="docutils literal notranslate"><span class="pre">fit</span> <span class="pre">()</span></code>. Une fois que nous avons la matrice de densité, nous pouvons calculer la fidélité, qui n’est que la moitié de la somme des quatre coins de la matrice de densité ; la méthode suivante nous aide:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit.ignis.verification.entanglement.analysis</span> <span class="kn">import</span> <span class="n">rho_to_fidelity</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho</span><span class="p">,</span> <span class="n">rho_em</span> <span class="o">=</span> <span class="n">tomo</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="p">,</span> <span class="n">tomo_em</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">F</span> <span class="o">=</span> <span class="n">rho_to_fidelity</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="n">F_em</span> <span class="o">=</span> <span class="n">rho_to_fidelity</span><span class="p">(</span><span class="n">rho_em</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Raw fidelity: &quot;</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error mitigated fidelity: &quot;</span><span class="p">,</span><span class="n">F_em</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Raw fidelity:  0.41135180830901596
Error mitigated fidelity:  0.6561026077224106
</pre></div></div>
</div>
<p>Comme nous le voyons, la fidélité brute est beaucoup plus faible que ce qui est obtenu avec les Oscillations MQC ou de parité, mais le résultat d’atténuation des erreurs est à peu près le même.</p>
<p><strong>Une note sur la tomographie</strong></p>
<p>Ne pas effectuer de tomographie quantique avec &gt; 5 qubits</p>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Lien permanent vers ce titre">¶</a></h2>
<p>En conclusion, nous voyons que sans atténuation des erreurs, le MQC est la meilleure méthode pour caractériser l’état GHZ. Cependant, avec l’atténuation des erreurs, toutes les méthodes peuvent, au moins pour un petit nombre de qubits, réaliser une fidélité beaucoup plus grande, toutes dans le même ordre de grandeur. Pour obtenir des résultats plus précis, mis à part l’utilisation d’un dispositif réel, il est utile d’augmenter le nombre de tirs de quatre à huit fois. Il peut aussi être utile de comparer la façon dont les circuits parallèles utilisés dans ce bloc-notes se comportent du point de vue de la fidélité par rapport à des circuits linéarisés.</p>
</div>
<div class="section" id="Collaborateurs-externes">
<h2>Collaborateurs externes<a class="headerlink" href="#Collaborateurs-externes" title="Lien permanent vers ce titre">¶</a></h2>
<p>Rohith Karur</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td>Qiskit</td><td>0.19.6</td></tr><tr><td>Terra</td><td>0.14.2</td></tr><tr><td>Aer</td><td>0.5.2</td></tr><tr><td>Ignis</td><td>0.3.3</td></tr><tr><td>Aqua</td><td>0.7.3</td></tr><tr><td>IBM Q Provider</td><td>0.7.2</td></tr><tr><th>System information</th></tr><tr><td>Python</td><td>3.7.6 (default, Jan  8 2020, 20:23:39) [MSC v.1916 64 bit (AMD64)]</td></tr><tr><td>OS</td><td>Windows</td></tr><tr><td>CPUs</td><td>8</td></tr><tr><td>Memory (Gb)</td><td>31.853038787841797</td></tr><tr><td colspan='2'>Tue Aug 11 16:57:06 2020 Jerusalem Summer Time</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2020.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../algorithms/index.html" class="btn btn-neutral float-right" title="Tutoriels sur les algorithmes" accesskey="n" rel="next">Next <img src="../../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="8_tomography.html" class="btn btn-neutral" title="Tomographie quantique" accesskey="p" rel="prev"><img src="../../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Qiskit Development Team.
      Mis à jour le 2021/03/29.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Vérification de l’intrication</a><ul>
<li><a class="reference internal" href="#Introduction-à-l'état-GHZ">Introduction à l’état GHZ</a></li>
<li><a class="reference internal" href="#Caractérisation-d'un-état-quantique">Caractérisation d’un état quantique</a></li>
<li><a class="reference internal" href="#Préparation-d'un-état-GHZ">Préparation d’un état GHZ</a></li>
<li><a class="reference internal" href="#Caractérisation,-Partie-I">Caractérisation, Partie I</a><ul>
<li><a class="reference internal" href="#Coherence-quantique-multiple-(MQC)">Coherence quantique multiple (MQC)</a></li>
<li><a class="reference internal" href="#Oscillations-de-parité">Oscillations de parité</a></li>
<li><a class="reference internal" href="#Tomographie">Tomographie</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Parallélisation-des-circuits">Parallélisation des circuits</a></li>
<li><a class="reference internal" href="#Atténuation-d'erreurs">Atténuation d’erreurs</a></li>
<li><a class="reference internal" href="#Phase-d'expérimentation">Phase d’expérimentation</a><ul>
<li><a class="reference internal" href="#Étapes-préliminaires">Étapes préliminaires</a></li>
<li><a class="reference internal" href="#Partie-1-:-MQC">Partie 1 : MQC</a></li>
<li><a class="reference internal" href="#Partie-2-:-Oscillation-de-parité">Partie 2 : Oscillation de parité</a></li>
<li><a class="reference internal" href="#Partie-3:-Tomographie">Partie 3: Tomographie</a></li>
<li><a class="reference internal" href="#Conclusion">Conclusion</a></li>
<li><a class="reference internal" href="#Collaborateurs-externes">Collaborateurs externes</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
         <script src="../../_static/jquery.js"></script>
         <script src="../../_static/underscore.js"></script>
         <script src="../../_static/doctools.js"></script>
         <script src="../../_static/language_data.js"></script>
         <script src="../../_static/thebelab-helper.js"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
         <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
         <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
         <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
     

  

  <script type="text/javascript" src="../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <div>
    <br>
  </div>

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://qiskit.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://qiskit.org/learn" target="_blank">Learning Resources</a>
          </li>

          <li>
            <a href="https://qiskit.slack.com" target="_blank">Slack Support</a>
          </li>

          <li>
            <a href="https://quantum-computing.ibm.com/" target="_blank">IBM Quantum Experience</a>
          </li>

          <li>
            <a href="https://github.com/Qiskit/" target="_blank">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>